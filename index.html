<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ø³Ø§ÛŒØª Ø¹Ø§Ø´Ù‚Ø§Ù†Ù‡ Ú©Ø§Ù…ÛŒØ§Ø±</title>
<style>
body {
  margin:0;
  padding:0;
  background: linear-gradient(135deg, #4b0082, #000);
  color:white;
  font-family:sans-serif;
  text-align:center;
  height:100vh;
  overflow:hidden;
  position:relative;
}

#startBtn {
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background: rgba(0,0,0,0.7);
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:32px;
  cursor:pointer;
  z-index:999;
}

#center-img {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  width:250px;
  border-radius:20px;
  box-shadow:0 0 20px rgba(255,255,255,0.5);
  z-index:2;
  animation: floaty 4s infinite alternate, glow 3s infinite alternate;
}

@keyframes floaty {0%{transform:translate(-50%,-50%) translateY(0);}100%{transform:translate(-50%,-50%) translateY(-15px);}}
@keyframes glow {0%{box-shadow:0 0 20px rgba(255,255,255,0.3);}50%{box-shadow:0 0 50px rgba(255,255,255,0.7);}100%{box-shadow:0 0 20px rgba(255,255,255,0.3);}}

#eqCanvas {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  z-index:1;
}

.footer {
  position:absolute;
  bottom:0;
  width:100%;
  padding:20px 0;
  font-size:24px;
  background:rgba(0,0,0,0.4);
  backdrop-filter:blur(4px);
}
</style>
</head>
<body>

<div id="startBtn">ğŸµ Ù„Ù…Ø³ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¢Ù‡Ù†Ú¯ Ù¾Ø®Ø´ Ø´ÙˆØ¯</div>

<audio id="player" src="ahang.mp3" preload="auto" playsinline></audio>
<img id="center-img" src="cheshm.jpg" alt="Ú†Ø´Ù… Ø¹Ø§Ø´Ù‚Ø§Ù†Ù‡">
<canvas id="eqCanvas" width="600" height="600"></canvas>
<div class="footer">Ú©Ø¯ÛŒÙ†Ú¯ Ø¨Ø§ÛŒ Ú©Ø§Ù…ÛŒØ§Ø±</div>

<script>
const audio=document.getElementById("player");
const canvas=document.getElementById("eqCanvas");
const ctx=canvas.getContext("2d");
const startBtn=document.getElementById("startBtn");
const centerImg=document.getElementById("center-img");
let audioCtx, analyser, source, dataArray, bufferLength;
let started=false;
const colors=['#FF0000','#FF7F00','#FFFF00','#00FF00','#0000FF','#4B0082','#8B00FF'];

// particles Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ
const particles=[];
for(let i=0;i<400;i++){
  particles.push({
    x:0, y:0, angle:Math.random()*2*Math.PI,
    radius:Math.random()*1.5+1, speed:Math.random()*1.5+0.5,
    color:colors[Math.floor(Math.random()*colors.length)],
    distance:Math.random()*200+50
  });
}

function setupAudio(){
  audioCtx=new(window.AudioContext||window.webkitAudioContext)();
  source=audioCtx.createMediaElementSource(audio);
  analyser=audioCtx.createAnalyser();
  source.connect(analyser);
  analyser.connect(audioCtx.destination);

  analyser.fftSize=256;
  bufferLength=analyser.frequencyBinCount;
  dataArray=new Uint8Array(bufferLength);
  draw();
}

let angleOffset=0;
function draw(){
  requestAnimationFrame(draw);
  analyser.getByteFrequencyData(dataArray);
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const centerX=canvas.width/2;
  const centerY=canvas.height/2;

  angleOffset+=0.01;

  // Ø³Ù‡ Ù„Ø§ÛŒÙ‡ Ø§Ú©ÙˆÙ„Ø§ÛŒØ²Ø±
  const layers=[100,140,180];
  layers.forEach((radiusLayer,layerIdx)=>{
    const bars=bufferLength;
    const step=(2*Math.PI)/bars;
    for(let i=0;i<bars;i++){
      const value=dataArray[i];
      const barHeight=value/2*(0.6+0.2*layerIdx);
      const angle=i*step+angleOffset*(layerIdx+1)*0.5;

      const x1=centerX+Math.cos(angle)*radiusLayer;
      const y1=centerY+Math.sin(angle)*radiusLayer;
      const x2=centerX+Math.cos(angle)*(radiusLayer+barHeight);
      const y2=centerY+Math.sin(angle)*(radiusLayer+barHeight);

      // gradient Ùˆ glow
      const grad=ctx.createLinearGradient(x1,y1,x2,y2);
      grad.addColorStop(0,colors[(i+layerIdx)%colors.length]);
      grad.addColorStop(1,'rgba(255,255,255,0.2)');

      ctx.strokeStyle=grad;
      ctx.shadowColor=colors[(i+layerIdx)%colors.length];
      ctx.shadowBlur=5+barHeight/5;
      ctx.lineWidth=3+layerIdx;
      ctx.beginPath();
      ctx.moveTo(x1,y1);
      ctx.lineTo(x2,y2);
      ctx.stroke();

      // Ø§Ù†ÙØ¬Ø§Ø± Ù†ÙˆØ± subtle
      if(barHeight>40){
        ctx.beginPath();
        ctx.arc(x2,y2,Math.random()*4+2,0,Math.PI*2);
        ctx.fillStyle=colors[(i+layerIdx)%colors.length];
        ctx.fill();
      }
    }
  });

  // particles Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø§ trail
  particles.forEach(p=>{
    p.x=centerX+Math.cos(p.angle)*(p.distance);
    p.y=centerY+Math.sin(p.angle)*(p.distance);
    p.angle+=0.01;
    ctx.beginPath();
    ctx.arc(p.x,p.y,p.radius*(1+Math.sin(Date.now()/800)/2),0,Math.PI*2);
    ctx.fillStyle=p.color;
    ctx.globalAlpha=0.6 + Math.sin(Date.now()/300)/4;
    ctx.fill();
  });
  ctx.globalAlpha=1;

  // scale Ùˆ rotate Ø¹Ú©Ø³ ÙˆØ³Ø·
  const scale=1+Math.sin(Date.now()/600)*0.03;
  centerImg.style.transform=`translate(-50%,-50%) scale(${scale}) rotate(${angleOffset*5}deg)`;
}

// Ø´Ø±ÙˆØ¹ Ù…ÙˆØ³ÛŒÙ‚ÛŒ Ùˆ Ø§Ú©ÙˆÙ„Ø§ÛŒØ²Ø±
startBtn.addEventListener("click",()=>{
  if(started) return;
  started=true;
  audio.play();
  setupAudio();
  startBtn.style.display="none";
});
startBtn.addEventListener("touchstart",()=>{
  if(started) return;
  started=true;
  audio.play();
  setupAudio();
  startBtn.style.display="none";
});
</script>

</body>
</html>
