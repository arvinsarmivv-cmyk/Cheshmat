<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ø³Ø§ÛŒØª Ú©Ø§Ù…ÛŒØ§Ø±</title>
<style>
  body {
    margin: 0;
    padding: 0;
    background: url("cheshm.jpg") no-repeat center center fixed;
    background-size: cover;
    color: white;
    font-family: sans-serif;
    text-align: center;
    height: 200vh; /* Ø¨Ù„Ù†Ø¯ Ø¨Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÙˆÙ„ */
    overflow-x: hidden;
  }

  .title {
    padding-top: 80px;
    font-size: 28px;
    text-shadow: 0 0 10px black;
  }

  canvas {
    display: block;
    margin: 40px auto;
    background: rgba(0,0,0,0.2);
    border-radius: 10px;
  }

  .footer {
    margin-top: 120vh;
    padding: 40px 0;
    font-size: 24px;
    background: rgba(0,0,0,0.4);
    backdrop-filter: blur(4px);
  }
</style>
</head>
<body>

<h2 class="title">Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ØŒ ØµÙØ­Ù‡ Ø±Ø§ Ù„Ù…Ø³ Ú©Ù†ÛŒØ¯ ğŸµ</h2>

<audio id="player" src="ahang.mp3" preload="auto" playsinline></audio>
<canvas id="eqCanvas" width="500" height="150"></canvas>

<div class="footer">Ú©Ø¯ÛŒÙ†Ú¯ Ø¨Ø§ÛŒ Ú©Ø§Ù…ÛŒØ§Ø±</div>

<script>
const audio = document.getElementById("player");
const canvas = document.getElementById("eqCanvas");
const ctx = canvas.getContext("2d");

let audioCtx, analyser, source, dataArray, bufferLength;
let started = false;

function setupAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(audio);
  analyser = audioCtx.createAnalyser();
  source.connect(analyser);
  analyser.connect(audioCtx.destination);

  analyser.fftSize = 64;
  bufferLength = analyser.frequencyBinCount;
  dataArray = new Uint8Array(bufferLength);

  draw();
}

function draw() {
  requestAnimationFrame(draw);
  analyser.getByteFrequencyData(dataArray);

  ctx.fillStyle = 'rgba(0,0,0,0.2)';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  const barWidth = (canvas.width / bufferLength) - 2;
  let x = 0;

  for (let i = 0; i < bufferLength; i++) {
    const barHeight = dataArray[i];
    ctx.fillStyle = `rgb(0, 255, 234)`;
    ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
    x += barWidth + 2;
  }
}

function startMusic() {
  if (started) return;
  started = true;

  audio.play();
  setupAudio();

  // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…ØªÙ† Ø±Ø§Ù‡Ù†Ù…Ø§
  document.querySelector('.title').style.display = 'none';

  // Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ù‡ Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ Ø¨Ù‡ Ø¢Ø±Ø§Ù…ÛŒ
  window.scrollTo({ top: 500, behavior: 'smooth' });
}

// ØªØ¹Ø§Ù…Ù„ ÙˆØ§Ù‚Ø¹ÛŒ Ø§Ø² Ú©Ø§Ø±Ø¨Ø±
document.body.addEventListener("click", startMusic, { once: true });
document.body.addEventListener("touchstart", startMusic, { once: true });
</script>

</body>
</html>
