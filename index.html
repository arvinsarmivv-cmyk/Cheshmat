<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>Ø³Ø§ÛŒØª Ø¹Ø§Ø´Ù‚Ø§Ù†Ù‡ Ú©Ø§Ù…ÛŒØ§Ø±</title>
<style>
  body {
    margin:0;
    padding:0;
    background: linear-gradient(135deg, #4b0082, #000);
    color:white;
    font-family:sans-serif;
    text-align:center;
    height:100vh;
    overflow:hidden;
    position:relative;
  }

  #startBtn {
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background: rgba(0,0,0,0.7);
    display:flex;
    justify-content:center;
    align-items:center;
    font-size:32px;
    cursor:pointer;
    z-index:999;
  }

  #center-img {
    position:absolute;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    width:250px;
    border-radius:20px;
    animation:pulse 2s infinite ease-in-out, floaty 4s infinite alternate;
    box-shadow:0 0 20px rgba(255,255,255,0.5);
    z-index:2;
  }

  @keyframes pulse {0%,100%{transform:translate(-50%,-50%) scale(1);}50%{transform:translate(-50%,-50%) scale(1.1);}}
  @keyframes floaty {0%{transform:translate(-50%,-50%) translateY(0);}100%{transform:translate(-50%,-50%) translateY(-20px);}}

  #eqCanvas {position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);z-index:1;}
  .footer {position:absolute;bottom:0;width:100%;padding:20px 0;font-size:24px;background:rgba(0,0,0,0.4);backdrop-filter:blur(4px);}
</style>
</head>
<body>

<div id="startBtn">ðŸŽµ Ù„Ù…Ø³ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¢Ù‡Ù†Ú¯ Ù¾Ø®Ø´ Ø´ÙˆØ¯</div>

<audio id="player" src="ahang.mp3" preload="auto" playsinline></audio>
<img id="center-img" src="cheshm.jpg" alt="Ú†Ø´Ù… Ø¹Ø§Ø´Ù‚Ø§Ù†Ù‡">
<canvas id="eqCanvas" width="500" height="500"></canvas>
<div class="footer">Ú©Ø¯ÛŒÙ†Ú¯ Ø¨Ø§ÛŒ Ú©Ø§Ù…ÛŒØ§Ø±</div>

<script>
const audio = document.getElementById("player");
const canvas = document.getElementById("eqCanvas");
const ctx = canvas.getContext("2d");
const startBtn = document.getElementById("startBtn");

let audioCtx, analyser, source, dataArray, bufferLength;
let started=false;
const colors=['#FF0000','#FF7F00','#FFFF00','#00FF00','#0000FF','#4B0082','#8B00FF'];

function setupAudio(){
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(audio);
  analyser = audioCtx.createAnalyser();
  source.connect(analyser);
  analyser.connect(audioCtx.destination);

  analyser.fftSize=128;
  bufferLength=analyser.frequencyBinCount;
  dataArray=new Uint8Array(bufferLength);
  draw();
}

function draw(){
  requestAnimationFrame(draw);
  analyser.getByteFrequencyData(dataArray);
  ctx.clearRect(0,0,canvas.width,canvas.height);

  const centerX=canvas.width/2;
  const centerY=canvas.height/2;
  const radius=120;
  const bars=bufferLength;
  const step=(2*Math.PI)/bars;

  for(let i=0;i<bars;i++){
    const value=dataArray[i];
    const barHeight=value/2;
    const angle=i*step;

    const x1=centerX+Math.cos(angle)*radius;
    const y1=centerY+Math.sin(angle)*radius;
    const x2=centerX+Math.cos(angle)*(radius+barHeight);
    const y2=centerY+Math.sin(angle)*(radius+barHeight);

    ctx.strokeStyle=colors[i % colors.length];
    ctx.lineWidth=4;
    ctx.beginPath();
    ctx.moveTo(x1,y1);
    ctx.lineTo(x2,y2);
    ctx.stroke();
  }
}

// ØªØ¹Ø§Ù…Ù„ ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±
startBtn.addEventListener("click", ()=>{
  if(started) return;
  started=true;
  audio.play();
  setupAudio();
  startBtn.style.display="none";
});
startBtn.addEventListener("touchstart", ()=>{
  if(started) return;
  started=true;
  audio.play();
  setupAudio();
  startBtn.style.display="none";
});
</script>

</body>
</html>
