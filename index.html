<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<title>â¤ï¸</title>
<style>
body {
  margin:0;
  padding:0;
  background: linear-gradient(135deg, #1b0030, #0f0c29);
  font-family:sans-serif;
  overflow:hidden;
  height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  text-align:center;
  color:white;
}

#overlay {
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background: rgba(0,0,0,0.7);
  display:flex;
  justify-content:center;
  align-items:center;
  font-size:28px;
  cursor:pointer;
  z-index:999;
}

#center-img {
  width:350px;
  border-radius:15px;
  box-shadow:0 0 30px rgba(255,255,255,0.5);
  position:relative;
  z-index:3;
  animation: floaty 4s infinite alternate;
}

#center-img span {
  position:absolute;
  top:0;
  left:0;
  width:100%;
  height:100%;
  cursor:pointer;
}

@keyframes floaty {0%{transform: translateY(0);}100%{transform: translateY(-15px);}}

#eqCanvas, #starsCanvas {
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  z-index:2;
}

.footer {
  position:absolute;
  bottom:0;
  width:100%;
  padding:15px 0;
  font-size:20px;
  background: rgba(0,0,0,0.3);
}

.footer a {
  color: #9b30ff;
  text-decoration:none;
}
</style>
</head>
<body>

<div id="overlay">ğŸµ Ù„Ù…Ø³ ÛŒØ§ Ø§Ø³Ú©Ø±ÙˆÙ„ Ú©Ù†ÛŒØ¯ ØªØ§ Ø¢Ù‡Ù†Ú¯ Ù¾Ø®Ø´ Ø´ÙˆØ¯</div>

<canvas id="starsCanvas" width="600" height="600"></canvas>
<canvas id="eqCanvas" width="600" height="600"></canvas>

<div style="position:relative;">
  <img id="center-img" src="cheshm.jpg" alt="Ú†Ø´Ù… Ø¹Ø§Ø´Ù‚Ø§Ù†Ù‡">
  <span onclick="window.open('tg://resolve?domain=kameiyar','_blank')"></span>
</div>

<audio id="player" src="ahang.mp3" preload="auto" playsinline></audio>

<div class="footer">Coded by <a href="https://t.me/kameiyar" target="_blank">kamiyar</a></div>

<script>
const overlay = document.getElementById('overlay');
const audio = document.getElementById('player');
const eqCanvas = document.getElementById('eqCanvas');
const eqCtx = eqCanvas.getContext('2d');
const starsCanvas = document.getElementById('starsCanvas');
const sCtx = starsCanvas.getContext('2d');
const centerImg = document.getElementById('center-img');

let audioCtx, analyser, source, dataArray, bufferLength;
let started = false;

// ØªØ§Ø¨Ø¹ Ø´Ø±ÙˆØ¹ Ø¢Ù‡Ù†Ú¯ Ùˆ Ø§Ú©ÙˆÙ„Ø§ÛŒØ²Ø± (ØªØ¶Ù…ÛŒÙ†ÛŒ)
function startAudio() {
  if (started) return;
  started = true;
  overlay.style.display = 'none';

  // AudioContext Ø¨Ø¹Ø¯ Ø§Ø² ØªØ¹Ø§Ù…Ù„ Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  source = audioCtx.createMediaElementSource(audio);
  analyser = audioCtx.createAnalyser();
  source.connect(analyser);
  analyser.connect(audioCtx.destination);
  analyser.fftSize = 128;
  bufferLength = analyser.frequencyBinCount;
  dataArray = new Uint8Array(bufferLength);

  audio.play().catch(err => console.log(err));
  drawEQ();
}

// Ú©ÙˆÚ†Ú©â€ŒØªØ±ÛŒÙ† ØªØ¹Ø§Ù…Ù„: Ù„Ù…Ø³ØŒ Ú©Ù„ÛŒÚ©ØŒ Ø§Ø³Ú©Ø±ÙˆÙ„
document.addEventListener('touchstart', startAudio, { once:true });
document.addEventListener('mousedown', startAudio, { once:true });
document.addEventListener('scroll', startAudio, { once:true });

// Ø§Ú©ÙˆÙ„Ø§ÛŒØ²Ø± Ú˜Ù„Ù‡â€ŒØ§ÛŒ Ù…Ø´Ú©ÛŒ-Ø¨Ù†ÙØ´
let angleOffset=0;
const eqColors = ['#000','#9b30ff'];

function drawEQ(){
  requestAnimationFrame(drawEQ);
  analyser.getByteFrequencyData(dataArray);
  eqCtx.clearRect(0,0,eqCanvas.width,eqCanvas.height);

  const centerX = eqCanvas.width/2;
  const centerY = eqCanvas.height/2;
  const radius = centerImg.width/2 + 20;
  const bars = bufferLength;
  const step = (2*Math.PI)/bars;
  angleOffset += 0.02;

  for(let i=0;i<bars;i++){
    const value = dataArray[i];
    const barHeight = value/2 + Math.sin(Date.now()/200+i)*10;
    const angle = i*step + angleOffset;
    const x1 = centerX + Math.cos(angle)*radius;
    const y1 = centerY + Math.sin(angle)*radius;
    const x2 = centerX + Math.cos(angle)*(radius+barHeight);
    const y2 = centerY + Math.sin(angle)*(radius+barHeight);

    const grad = eqCtx.createLinearGradient(x1,y1,x2,y2);
    grad.addColorStop(0, eqColors[0]);
    grad.addColorStop(1, eqColors[1]);

    eqCtx.strokeStyle = grad;
    eqCtx.lineWidth = 4;
    eqCtx.shadowBlur = 8;
    eqCtx.shadowColor = eqColors[1];
    eqCtx.beginPath();
    eqCtx.moveTo(x1,y1);
    eqCtx.lineTo(x2,y2);
    eqCtx.stroke();
  }
}

// Ø³ØªØ§Ø±Ù‡â€ŒÙ‡Ø§ (*) Ø§Ø² Ø¨Ø§Ù„Ø§ÛŒ Ø¹Ú©Ø³ ØªØ§ Ù¾Ø§ÛŒÛŒÙ†
const stars = [];
const starCount = 100;

for(let i=0;i<starCount;i++){
  stars.push({
    x: Math.random()*window.innerWidth,
    y: Math.random()*centerImg.offsetTop,
    size: Math.random()*3+1,
    speed: Math.random()*1+0.5
  });
}

function drawStars(){
  sCtx.clearRect(0,0,starsCanvas.width,starsCanvas.height);
  stars.forEach(s=>{
    sCtx.fillStyle = 'white';
    sCtx.shadowBlur = 5;
    sCtx.shadowColor = 'white';
    sCtx.font = `${s.size*5}px Arial`;
    sCtx.fillText('*', s.x, s.y);
    s.y += s.speed;
    if(s.y > centerImg.offsetTop + centerImg.offsetHeight){
      s.y = centerImg.offsetTop;
      s.x = Math.random()*window.innerWidth;
    }
  });
  requestAnimationFrame(drawStars);
}
drawStars();

// Ø±ÛŒâ€ŒØ³Ø§ÛŒØ² canvas
window.addEventListener('resize',()=>{
  eqCanvas.width = window.innerWidth;
  eqCanvas.height = window.innerHeight;
  starsCanvas.width = window.innerWidth;
  starsCanvas.height = window.innerHeight;
});
</script>

</body>
</html>
